<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>HeoCon88 - Khuy·∫øn M√£i</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
    body {
        font-family: 'Outfit', sans-serif;
        background-color: #0f172a;
        background-image: 
            radial-gradient(at 0% 0%, hsla(253,16%,7%,1) 0, transparent 50%), 
            radial-gradient(at 50% 0%, hsla(225,39%,30%,1) 0, transparent 50%), 
            radial-gradient(at 100% 0%, hsla(339,49%,30%,1) 0, transparent 50%);
        color: #e2e8f0;
        min-height: 100vh;
        -webkit-tap-highlight-color: transparent;
    }

    .glass-nav {
        background: rgba(15, 23, 42, 0.85);
        backdrop-filter: blur(12px);
        border-bottom: 1px solid rgba(255,255,255,0.05);
    }

    .glass-card {
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(16px);
        border: 1px solid rgba(255, 255, 255, 0.08);
        box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        transition: transform 0.2s, background 0.2s;
    }
    .glass-card:active {
        transform: scale(0.98);
        background: rgba(255, 255, 255, 0.1);
    }

    .promo-tag {
        background: linear-gradient(90deg, #ef4444, #f97316);
        box-shadow: 0 2px 10px rgba(239, 68, 68, 0.4);
    }
    
    .promo-free {
        background: linear-gradient(90deg, #10b981, #3b82f6);
        box-shadow: 0 2px 10px rgba(16, 185, 129, 0.4);
    }

    /* Modal Animation */
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
    
    .modal-overlay { animation: fadeIn 0.2s ease-out; }
    .modal-content { animation: slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1); }

    /* Custom Scrollbar for Tags */
    .hide-scrollbar::-webkit-scrollbar { display: none; }
    .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

    /* Button States */
    .btn-pending { background: #eab308; cursor: not-allowed; color: #000; }
    .btn-success { background: #22c55e; cursor: not-allowed; }
    .btn-failed { background: #ef4444; cursor: not-allowed; }
</style>
</head>
<body class="flex flex-col pb-10">

<!-- HEADER -->
<header class="glass-nav sticky top-0 z-50 px-4 py-4 flex items-center justify-between">
    <button onclick="goHome()" class="w-10 h-10 rounded-full hover:bg-white/10 flex items-center justify-center transition">
        <i class="fa-solid fa-arrow-left text-lg text-white"></i>
    </button>
    <h1 class="text-lg font-bold text-white tracking-wide">S·ª± Ki·ªán & Khuy·∫øn M√£i</h1>
    <div class="w-10"></div>
</header>

<!-- MAIN CONTENT -->
<main class="flex-1 p-4">

    <!-- CATEGORY TABS -->
    <div class="flex gap-3 overflow-x-auto hide-scrollbar mb-6 pb-2">
        <button onclick="filterPromo('all')" id="btn-all" class="cat-btn px-5 py-2 rounded-full bg-white text-slate-900 font-bold text-sm whitespace-nowrap shadow-lg transition">T·∫•t c·∫£</button>
        <button onclick="filterPromo('deposit')" id="btn-deposit" class="cat-btn px-5 py-2 rounded-full bg-white/10 text-slate-300 font-medium text-sm whitespace-nowrap hover:bg-white/20 transition">N·∫°p ti·ªÅn</button>
        <button onclick="filterPromo('free')" id="btn-free" class="cat-btn px-5 py-2 rounded-full bg-white/10 text-slate-300 font-medium text-sm whitespace-nowrap hover:bg-white/20 transition">Tr·∫£i nghi·ªám</button>
        <button onclick="filterPromo('refund')" id="btn-refund" class="cat-btn px-5 py-2 rounded-full bg-white/10 text-slate-300 font-medium text-sm whitespace-nowrap hover:bg-white/20 transition">Ho√†n tr·∫£</button>
    </div>

    <!-- PROMO LIST -->
    <div id="promo-list" class="space-y-4">
        
        <!-- Item 1: N·∫°p ƒë·∫ßu (Updated) -->
        <div class="glass-card rounded-2xl p-0 overflow-hidden cursor-pointer group" data-cat="deposit" onclick="openModal('promo1')">
            <div class="relative h-32 bg-gradient-to-r from-red-600 to-orange-600 flex items-center justify-center overflow-hidden">
                <i class="fa-solid fa-sack-dollar text-8xl text-white/10 absolute -right-4 -bottom-4 group-hover:scale-110 transition duration-500"></i>
                <div class="text-center z-10">
                    <h3 class="text-2xl font-black text-white drop-shadow-md">N·∫†P ƒê·∫¶U</h3>
                    <p class="text-sm text-white/90 font-medium uppercase tracking-wider">T·∫∑ng 100%</p>
                </div>
                <div class="absolute top-3 right-3 promo-tag text-[10px] font-bold text-white px-2 py-1 rounded shadow-sm">HOT</div>
            </div>
            <div class="p-4 flex justify-between items-center">
                <div>
                    <h4 class="font-bold text-white">Th∆∞·ªüng n·∫°p 580k - 1.58M</h4>
                    <p class="text-xs text-slate-400 mt-1">D√†nh cho h·ªôi vi√™n n·∫°p l·∫ßn ƒë·∫ßu</p>
                </div>
                <div id="status-preview-promo1" class="text-xs font-bold px-2 py-1 rounded bg-slate-700 text-slate-400">Chi ti·∫øt</div>
            </div>
        </div>

        <!-- Item 2: Tr·∫£i nghi·ªám (New) -->
        <div class="glass-card rounded-2xl p-0 overflow-hidden cursor-pointer group" data-cat="free" onclick="openModal('promo2')">
            <div class="relative h-32 bg-gradient-to-r from-emerald-500 to-cyan-500 flex items-center justify-center overflow-hidden">
                <i class="fa-solid fa-gift text-8xl text-white/10 absolute -left-4 -bottom-4 group-hover:scale-110 transition duration-500"></i>
                <div class="text-center z-10">
                    <h3 class="text-3xl font-black text-white drop-shadow-md">280K</h3>
                    <p class="text-sm text-white/90 font-medium uppercase tracking-wider">Ti·ªÅn tr·∫£i nghi·ªám</p>
                </div>
                <div class="absolute top-3 left-3 promo-free text-[10px] font-bold text-white px-2 py-1 rounded shadow-sm">FREE</div>
            </div>
            <div class="p-4 flex justify-between items-center">
                <div>
                    <h4 class="font-bold text-white">T·∫∑ng v·ªën kh·ªüi nghi·ªáp</h4>
                    <p class="text-xs text-slate-400 mt-1">ƒêƒÉng k√Ω nh·∫≠n ngay 280.000 Coin</p>
                </div>
                <div id="status-preview-promo2" class="text-xs font-bold px-2 py-1 rounded bg-slate-700 text-slate-400">Chi ti·∫øt</div>
            </div>
        </div>

        <!-- Item 3: Ho√†n tr·∫£ -->
        <div class="glass-card rounded-2xl p-0 overflow-hidden cursor-pointer group" data-cat="refund" onclick="openModal('promo3')">
            <div class="relative h-24 bg-gradient-to-r from-slate-700 to-slate-600 flex items-center justify-between px-6 overflow-hidden">
                <div class="z-10">
                    <h3 class="text-xl font-black text-white">1.5%</h3>
                    <p class="text-xs text-white/90 font-medium uppercase">Ho√†n tr·∫£ m·ªói ng√†y</p>
                </div>
                <i class="fa-solid fa-rotate-left text-4xl text-white/20"></i>
            </div>
            <div class="p-3">
                <h4 class="font-bold text-white text-sm">Ho√†n tr·∫£ v√¥ t·∫≠n</h4>
            </div>
        </div>

    </div>

    <!-- EMPTY STATE -->
    <div id="empty-state" class="hidden text-center py-10 opacity-60">
        <i class="fa-solid fa-box-open text-4xl text-slate-500 mb-3"></i>
        <p class="text-sm text-slate-400">Kh√¥ng c√≥ khuy·∫øn m√£i n√†o trong m·ª•c n√†y</p>
    </div>

</main>

<!-- MODAL POPUP -->
<div id="detail-modal" class="fixed inset-0 z-[100] hidden">
    <!-- Overlay -->
    <div class="absolute inset-0 bg-black/80 backdrop-blur-sm modal-overlay" onclick="closeModal()"></div>
    
    <!-- Content -->
    <div class="absolute bottom-0 left-0 w-full bg-[#1e293b] rounded-t-3xl overflow-hidden modal-content border-t border-white/10">
        <!-- Header Image -->
        <div class="h-32 bg-gradient-to-r from-blue-600 to-indigo-600 relative flex items-center justify-center transition-colors duration-300" id="modal-header-bg">
            <button onclick="closeModal()" class="absolute top-4 right-4 w-8 h-8 bg-black/20 rounded-full text-white flex items-center justify-center hover:bg-black/40 transition z-20">
                <i class="fa-solid fa-xmark"></i>
            </button>
            <i id="modal-icon" class="fa-solid fa-gift text-6xl text-white/20 absolute"></i>
            <h2 id="modal-title" class="text-xl font-bold text-white z-10 text-center px-4 uppercase drop-shadow-md">Ti√™u ƒë·ªÅ KM</h2>
        </div>
        
        <!-- Body -->
        <div class="p-6 pb-8 bg-[#0f172a]">
            <div class="prose prose-invert prose-sm max-w-none">
                <h3 class="text-emerald-400 font-bold mb-2 text-sm">üéÅ Chi ti·∫øt ∆∞u ƒë√£i:</h3>
                <div id="modal-desc" class="text-slate-300 mb-4 leading-relaxed text-sm bg-slate-800/50 p-3 rounded-lg border border-slate-700">
                    <!-- Content injected via JS -->
                </div>
                
                <h3 class="text-emerald-400 font-bold mb-2 text-sm">‚ö† L∆∞u √Ω:</h3>
                <ul class="list-disc list-inside text-slate-400 space-y-1 text-xs">
                    <li>M·ªôt IP/Thi·∫øt b·ªã ch·ªâ ƒë∆∞·ª£c nh·∫≠n 1 l·∫ßn.</li>
                    <li>Nghi√™m c·∫•m h√†nh vi b√†o khuy·∫øn m√£i.</li>
                    <li>Quy·∫øt ƒë·ªãnh c·ªßa Admin l√† quy·∫øt ƒë·ªãnh cu·ªëi c√πng.</li>
                </ul>
            </div>

            <!-- Action Button -->
            <button id="modal-action-btn" class="w-full mt-6 font-bold py-3.5 rounded-xl shadow-lg transition flex items-center justify-center gap-2">
                <span>ƒêƒÉng K√Ω Ngay</span>
            </button>
        </div>
    </div>
</div>

<script>
    // === D·ªØ li·ªáu Khuy·∫øn M√£i (Updated) ===
    const promoData = {
        'promo1': {
            title: "N·∫†P ƒê·∫¶U 580K - 1.58M",
            icon: "fa-sack-dollar",
            bg: "from-red-600 to-orange-600",
            desc: `
                <p>Th∆∞·ªüng n√≥ng cho h·ªôi vi√™n m·ªõi n·∫°p ti·ªÅn l·∫ßn ƒë·∫ßu:</p>
                <ul class="mt-2 space-y-1">
                    <li>- N·∫°p <b>580.000</b> Coin nh·∫≠n th√™m th∆∞·ªüng.</li>
                    <li>- N·∫°p <b>1.580.000</b> Coin nh·∫≠n g√≥i k√≠ch ho·∫°t VIP.</li>
                    <li>- Y√™u c·∫ßu: 1 v√≤ng c∆∞·ª£c l·∫°i tr∆∞·ªõc khi r√∫t.</li>
                </ul>
            `
        },
        'promo2': {
            title: "T·∫∂NG 280K TR·∫¢I NGHI·ªÜM",
            icon: "fa-gift",
            bg: "from-emerald-500 to-cyan-500",
            desc: `
                <p>Qu√† t·∫∑ng kh·ªüi nghi·ªáp d√†nh cho t√¢n th·ªß:</p>
                <ul class="mt-2 space-y-1">
                    <li>- Nh·∫≠n ngay <b>280.000 Coin</b> v√†o v√≠ ch√≠nh.</li>
                    <li>- √Åp d·ª•ng cho t·∫•t c·∫£ tr√≤ ch∆°i (Tr·ª´ X·ªï s·ªë).</li>
                    <li>- Th·∫Øng tr√™n 500k ƒë∆∞·ª£c ph√©p r√∫t ti·ªÅn.</li>
                </ul>
            `
        },
        'promo3': {
            title: "HO√ÄN TR·∫¢ 1.5%",
            icon: "fa-rotate-left",
            bg: "from-slate-700 to-slate-600",
            desc: "Ho√†n tr·∫£ kh√¥ng gi·ªõi h·∫°n m·ªói ng√†y. T·ª± ƒë·ªông c·ªông v√†o 13:00."
        }
    };

    let uid = localStorage.getItem("my_wallet_uid");
    let currentPromoId = null;

    // === H√ÄM CH√çNH ===

    function goHome() {
        location.href = "home.html";
    }

    // L·ªçc khuy·∫øn m√£i
    function filterPromo(category) {
        document.querySelectorAll('.cat-btn').forEach(btn => {
            btn.className = "cat-btn px-5 py-2 rounded-full bg-white/10 text-slate-300 font-medium text-sm whitespace-nowrap hover:bg-white/20 transition";
        });
        const activeBtn = document.getElementById(`btn-${category}`);
        activeBtn.className = "cat-btn px-5 py-2 rounded-full bg-white text-slate-900 font-bold text-sm whitespace-nowrap shadow-lg transition";

        const items = document.querySelectorAll('#promo-list > div');
        let hasItem = false;
        items.forEach(item => {
            if (category === 'all' || item.getAttribute('data-cat') === category) {
                item.style.display = 'block';
                hasItem = true;
            } else {
                item.style.display = 'none';
            }
        });
        document.getElementById('empty-state').classList.toggle('hidden', hasItem);
    }

    // M·ªü Modal
    function openModal(promoId) {
        if(!uid) {
            alert("Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ xem chi ti·∫øt!");
            return location.href = "index.html";
        }

        const data = promoData[promoId];
        if(!data) return;

        currentPromoId = promoId;

        // Render Content
        document.getElementById('modal-title').innerText = data.title;
        document.getElementById('modal-desc').innerHTML = data.desc;
        document.getElementById('modal-icon').className = `fa-solid ${data.icon} text-6xl text-white/20 absolute`;
        document.getElementById('modal-header-bg').className = `h-32 bg-gradient-to-r ${data.bg} relative flex items-center justify-center transition-colors duration-300`;

        // Check Status & Render Button
        updateButtonState();

        document.getElementById('detail-modal').classList.remove('hidden');
    }

    function closeModal() {
        document.getElementById('detail-modal').classList.add('hidden');
    }

    // === LOGIC X·ª¨ L√ù TR·∫†NG TH√ÅI ===
    
    // L·∫•y tr·∫°ng th√°i t·ª´ LocalStorage (Gi·∫£ l·∫≠p DB)
    function getStatus(promoId) {
        const key = `promo_status_${uid}_${promoId}`;
        return localStorage.getItem(key) || 'none'; // none, pending, success, failed
    }

    function setStatus(promoId, status) {
        const key = `promo_status_${uid}_${promoId}`;
        localStorage.setItem(key, status);
        updateButtonState();
        updatePreviewBadge(promoId, status);
    }

    // C·∫≠p nh·∫≠t n√∫t b·∫•m trong Modal
    function updateButtonState() {
        const status = getStatus(currentPromoId);
        const btn = document.getElementById('modal-action-btn');

        // Reset classes
        btn.className = "w-full mt-6 font-bold py-3.5 rounded-xl shadow-lg transition flex items-center justify-center gap-2";
        btn.onclick = null;

        if (status === 'none') {
            // Ch∆∞a ƒëƒÉng k√Ω
            btn.classList.add('bg-gradient-to-r', 'from-indigo-500', 'to-purple-600', 'hover:from-indigo-600', 'text-white', 'active:scale-95');
            btn.innerHTML = '<span>ƒêƒÉng K√Ω Tham Gia</span> <i class="fa-solid fa-arrow-right"></i>';
            btn.onclick = handleRegister;
        } else if (status === 'pending') {
            // ƒêang x·ª≠ l√Ω (V√†ng)
            btn.classList.add('btn-pending');
            btn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> <span>ƒêang X·ª≠ L√Ω...</span>';
        } else if (status === 'success') {
            // Th√†nh c√¥ng (Xanh)
            btn.classList.add('btn-success', 'text-white');
            btn.innerHTML = '<i class="fa-solid fa-check-circle"></i> <span>ƒê√£ Th√†nh C√¥ng</span>';
        } else if (status === 'failed') {
            // Th·∫•t b·∫°i (ƒê·ªè)
            btn.classList.add('btn-failed', 'text-white');
            btn.innerHTML = '<i class="fa-solid fa-circle-xmark"></i> <span>Kh√¥ng Th√†nh C√¥ng</span>';
        }
    }

    // X·ª≠ l√Ω khi b·∫•m ƒêƒÉng K√Ω
    function handleRegister() {
        if (!confirm("X√°c nh·∫≠n ƒëƒÉng k√Ω tham gia khuy·∫øn m√£i n√†y?")) return;

        // 1. Chuy·ªÉn sang ƒêang X·ª≠ L√Ω
        setStatus(currentPromoId, 'pending');

        // 2. Gi·∫£ l·∫≠p Admin duy·ªát sau 5 gi√¢y (ƒê·ªÉ b·∫°n test)
        // Trong th·ª±c t·∫ø, b∆∞·ªõc n√†y Admin l√†m tr√™n trang Admin
        setTimeout(() => {
            // Random k·∫øt qu·∫£ ƒë·ªÉ test: 70% th√†nh c√¥ng, 30% th·∫•t b·∫°i
            const isApproved = Math.random() > 0.3; 
            const finalStatus = isApproved ? 'success' : 'failed';
            
            setStatus(currentPromoId, finalStatus);
            
            // N·∫øu modal ƒëang m·ªü th√¨ c·∫≠p nh·∫≠t l·∫°i n√∫t ngay l·∫≠p t·ª©c
            if(!document.getElementById('detail-modal').classList.contains('hidden')){
                updateButtonState();
            }
        }, 5000); // 5 gi√¢y sau t·ª± duy·ªát
    }

    // C·∫≠p nh·∫≠t Badge b√™n ngo√†i danh s√°ch (Optional UX)
    function updatePreviewBadge(promoId, status) {
        const badge = document.getElementById(`status-preview-${promoId}`);
        if (!badge) return;

        if (status === 'pending') {
            badge.className = "text-xs font-bold px-2 py-1 rounded bg-yellow-500/20 text-yellow-400 border border-yellow-500/50";
            badge.innerText = "ƒêang x·ª≠ l√Ω";
        } else if (status === 'success') {
            badge.className = "text-xs font-bold px-2 py-1 rounded bg-green-500/20 text-green-400 border border-green-500/50";
            badge.innerText = "ƒê√£ nh·∫≠n";
        } else if (status === 'failed') {
            badge.className = "text-xs font-bold px-2 py-1 rounded bg-red-500/20 text-red-400 border border-red-500/50";
            badge.innerText = "T·ª´ ch·ªëi";
        }
    }

    // Load tr·∫°ng th√°i ban ƒë·∫ßu khi v√†o trang
    window.onload = function() {
        if(uid) {
            ['promo1', 'promo2'].forEach(pid => {
                const s = getStatus(pid);
                if(s !== 'none') updatePreviewBadge(pid, s);
            });
        }
    }

</script>

</body>
</html>


